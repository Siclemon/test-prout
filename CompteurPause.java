import java.time.DayOfWeek;
import java.time.Duration;
import java.time.LocalDate;
import java.time.LocalTime;
import java.time.format.DateTimeFormatter;
import java.time.format.TextStyle;
import java.util.HashMap;
import java.util.Locale;

public class CompteurPause {
    public static void main(String[] args) {
        LocalDate date = LocalDate.now();
        LocalTime mtn = LocalTime.now();
        DateTimeFormatter hms = DateTimeFormatter.ofPattern("HH:mm:ss");
        Duration duree;
        LocalTime pause = LocalTime.parse("17:00:00");
        int temps=1, secondes, minutes, heures;
        String avant =" ";
        DayOfWeek jour = DayOfWeek.from(date);
        String jourr;
        String[] pauses = {"10:00:00", "13:00:00", "15:15:00", "17:00:00", "19:12:00"}; //supprimer la pause de test
        String[][] zero = {{" "," "," "," ",".","n","~","~","%","x","."," "," "," "," "},{" "," ","x","8","8","X"," "," "," ","8","8","8","."," "," "},{" ","X","8","8","8","X"," "," "," ","8","8","8","8","L"," "},{"X","8","8","8","8","X"," "," "," ","8","8","8","8","8"," "},{"8","8","8","8","8","X"," "," "," ","8","8","8","8","8","X"},{"8","8","8","8","8","X"," "," "," ","8","8","8","8","8","X"},{"8","8","8","8","8","X"," "," "," ","8","8","8","8","8","f"},{"4","8","8","8","8","X"," "," "," ","8","8","8","8","8"," "},{" ","?","8","8","8","X"," "," "," ","8","8","8","8","\""," "},{" "," ","\"","8","8","X"," "," "," ","8","8","*","`"," "," "},{" "," "," "," ","^","\"","=","=","=","\"","`"," "," "," "," "}};
        String[][] un = {{" "," "," "," "," "," "," "," ","o","e"," "," "," "," "," "},{" "," "," "," "," "," ",".","@","8","8"," "," "," "," "," "},{" "," ","=","=","*","8","8","8","8","8"," "," "," "," "," "},{" "," "," "," "," ","8","8","8","8","8"," "," "," "," "," "},{" "," "," "," "," ","8","8","8","8","8"," "," "," "," "," "},{" "," "," "," "," ","8","8","8","8","8"," "," "," "," "," "},{" "," "," "," "," ","8","8","8","8","8"," "," "," "," "," "},{" "," "," "," "," ","8","8","8","8","8"," "," "," "," "," "},{" "," "," "," "," ","8","8","8","8","8"," "," "," "," "," "},{" "," "," "," "," ","8","8","8","8","8"," "," "," "," "," "},{" "," ","'","*","*","%","%","%","%","%","%","*","*"," "," "}};
        String[][] deux = {{" "," "," ",".","-","-","~","*","t","e","u","."," "," "," "},{" "," ","d","F"," "," "," "," "," ","9","8","8","N","x"," "},{" ","d","8","8","8","b"," "," "," ","`","8","8","8","8",">"},{" ","?","8","8","8","8",">"," "," ","9","8","8","8","8","F"},{" "," ","\"","*","*","\""," "," ","x","8","8","8","8","8","~"},{" "," "," "," "," "," "," ","d","8","8","8","8","*","`"," "},{" "," "," "," "," ","z","8","*","*","\"","`"," "," "," ",":"},{" "," "," ",":","?",".",".",".",".","."," "," ",".",".","F"},{" "," ","<","\"","\"","8","8","8","8","8","8","8","8","8","~"},{" "," ","8",":"," "," ","\"","8","8","8","8","8","8","*"," "},{" "," ","\"","\""," "," "," "," ","\"","*","*","\"","`"," "," "}};
        String[][] trois = {{" "," "," ",".","x","~","~","\"","*","W","e","u","."," "," "},{" "," ","d","8","N","u","."," "," ","9","8","8","8","c"," "},{" "," ","8","8","8","8","8"," "," ","9","8","8","8","8"," "},{" "," ","\"","*","*","*","\""," "," ","9","8","8","8","%"," "},{" "," "," "," "," "," "," ",".",".","@","8","*","\""," "," "},{" "," "," "," ","`","`","`","`","\"","8","W","e","u"," "," "},{" "," "," ",".","."," "," "," "," ","?","8","8","8","8","L"},{" ",":","@","8","8","N"," "," "," ","'","8","8","8","8","N"},{" ","*","8","8","8","8","~"," "," ","'","8","8","8","8","F"},{" ","'","*","8","\"","`"," "," "," ","9","8","8","8","%"," "},{" "," "," ","`","~","=","=","=","*","%","\"","`"," "," "," "}};
        String[][] quatre = {{" "," "," "," "," "," "," "," ","x","e","e","e"," "," "," "},{" "," "," "," "," "," "," ","d","8","8","8","R"," "," "," "},{" "," "," "," "," "," ","d","8","8","8","8","R"," "," "," "},{" "," "," "," "," ","@"," ","8","8","8","8","R"," "," "," "},{" "," "," ",".","P"," "," ","8","8","8","8","R"," "," "," "},{" "," ",":","F"," "," "," ","8","8","8","8","R"," "," "," "},{" ","x","\""," "," "," "," ","8","8","8","8","R"," "," "," "},{"d","8","e","e","e","e","e","8","8","8","8","8","e","e","r"},{" "," "," "," "," "," "," ","8","8","8","8","R"," "," "," "},{" "," "," "," "," "," "," ","8","8","8","8","R"," "," "," "},{" "," "," "," ","\"","*","%","%","%","%","%","%","*","*","~"}};
        String[][] cinq = {{" "," ","c","u","u","u",".",".",".",".","u","K"," "," "," "},{" "," ","8","8","8","8","8","8","8","8","8"," "," "," "," "},{" "," ","8","*","8","8","8","*","*","\""," "," "," "," "," "},{" "," ",">"," "," ",".",".",".",".","."," "," "," "," "," "},{" "," ","L","z","\""," "," ","^","8","8","8","N","u"," "," "},{" "," ","F"," "," "," "," "," ","'","8","8","8","8","k"," "},{" "," ",".","."," "," "," "," "," ","8","8","8","8","8",">"},{" ","@","8","8","8","L"," "," "," ","8","8","8","8","8"," "},{"'","8","8","8","8","F"," "," "," ","8","8","8","8","F"," "},{" ","%","8","F","\""," "," "," ","d","8","8","8","\""," "," "},{" "," ","^","\"","=","=","=","*","%","\"","`"," "," "," "," "}};
        String[][] six = {{" "," "," "," "," ",".","u","e","~","~","%","u","."," "," "},{" "," "," ",".","d","8","8"," "," "," ","z","8","8","i"," "},{" "," ","x","8","8","8","E"," "," ","*","8","8","8","8"," "},{" ",":","8","8","8","8","E"," "," "," ","^","\"","\""," "," "},{" ","9","8","8","8","8","E",".","=","t","W","c","."," "," "},{" ","9","8","8","8","8","N"," "," ","'","8","8","8","N"," "},{" ","9","8","8","8","8","E"," "," "," ","8","8","8","8","E"},{" ","'","8","8","8","8","E"," "," "," ","8","8","8","8","E"},{" "," ","?","8","8","8","E"," "," "," ","8","8","8","8","\""},{" "," "," ","\"","8","8","&"," "," "," ","8","8","8","\""," "},{" "," "," "," "," ","\"","\"","=","=","*","\"","\""," "," "," "}};
        String[][] sept = {{" ","d","L"," ","u","d","8","N","u"," "," ",":","8","c"," "},{" ","8","F","d","8","8","8","8","8","8","L"," ","%","8"," "},{" ","4","N","8","8","8","8","8","8","8","8","c","u","R"," "},{" ","4","F"," "," "," ","^","\"","\"","%","\"","\"","d"," "," "},{" ","d"," "," "," "," "," "," "," ",".","z","8"," "," "," "},{" ","^"," "," "," "," "," ","z","8","8","8"," "," "," "," "},{" "," "," "," "," ","d","8","8","8","8","'"," "," "," "," "},{" "," "," "," ","8","8","8","8","8","8"," "," "," "," "," "},{" "," "," ",":","8","8","8","8","8","8"," "," "," "," "," "},{" "," "," "," ","8","8","8","8","8","8"," "," "," "," "," "},{" "," "," "," ","'","%","*","*","%"," "," "," "," "," "," "}};
        String[][] huit = {{" "," "," ","u","+","=","~","~","~","+","u","."," "," "," "},{" ","z","8","F"," "," "," "," "," "," ","`","8","N","."," "},{"d","8","8","L"," "," "," "," "," "," "," ","9","8","E"," "},{"9","8","8","8","8","b","u",".","."," ",".","@","*"," "," "},{"\"","8","8","8","8","8","8","8","8","N","N","u","."," "," "},{" ","\"","*","8","8","8","8","8","8","8","8","8","8","i"," "},{" ",".","z","f","\"","\"","*","8","8","8","8","8","8","8","L"},{"d","8","F"," "," "," "," "," "," ","^","%","8","8","8","E"},{"8","8",">"," "," "," "," "," "," "," "," ","`","8","8","~"},{"'","%","N","."," "," "," "," "," "," "," ","d","*","\""," "},{" "," "," ","^","\"","=","=","=","=","=","\"","`"," "," "," "}};
        String[][] neuf = {{" "," "," ",".","x","n","!","~","%","x","."," "," "," "," "},{" "," ","x","8","8","8"," "," "," ","8","8","8","."," "," "},{" ","X","8","8","8","8"," "," "," ","8","8","8","8",":"," "},{" ","8","8","8","8","8"," "," "," ","X","8","8","8","8"," "},{" ","8","8","8","8","8"," "," "," ","8","8","8","8","8",">"},{" ","`","8","8","8","8"," "," ",":","8","8","8","8","8","X"},{" "," "," ","`","\"","*","*","~"," ","8","8","8","8","8",">"},{" "," ",".","x","x","."," "," "," ","8","8","8","8","8"," "},{" ","'","8","8","8","8",">"," "," ","8","8","8","8","~"," "},{" "," ","8","8","8","\""," "," ",":","8","8","%"," "," "," "},{" "," "," ","^","\"","=","=","=","\"","\""," "," "," "," "," "}};
        String[][] points = {{" "," "," ","."," "," "},{" "," ","d","8","c"," "},{"^","*","8","8","8","%"},{" "," ","\"","8"," "," "},{" "," "," "," "," "," "},{" "," "," ","."," "," "},{" ",".","@","8","c"," "},{"'","%","8","8","8","\""},{" "," ","^","*"," "," "}};
        String[][] textePause = {{"P","P","P","P","P","P","P","P","P","P","P","P","P","P","P","P","P"," "," "," "," "," "," "," "," "," "," "," "," "," "," ","A","A","A"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","U","U","U","U","U","U","U","U"," "," "," "," "," "," "," "," ","U","U","U","U","U","U","U","U"," "," "," "," "," "," "," "," ","S","S","S","S","S","S","S","S","S","S","S","S","S","S","S"," "," "," "," "," "," ","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E"},{"P",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","P"," "," "," "," "," "," "," "," "," "," "," "," ","A",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","U",":",":",":",":",":",":","U"," "," "," "," "," "," "," "," ","U",":",":",":",":",":",":","U"," "," "," "," "," "," ","S","S",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","S"," "," "," "," "," ","E",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","E"},{"P",":",":",":",":",":",":","P","P","P","P","P","P",":",":",":",":",":","P"," "," "," "," "," "," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","U",":",":",":",":",":",":","U"," "," "," "," "," "," "," "," ","U",":",":",":",":",":",":","U"," "," "," "," "," ","S",":",":",":",":",":","S","S","S","S","S","S",":",":",":",":",":",":","S"," "," "," "," "," ","E",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","E"},{"P","P",":",":",":",":",":","P"," "," "," "," "," ","P",":",":",":",":",":","P"," "," "," "," "," "," "," "," ","A",":",":",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," "," "," "," ","U","U",":",":",":",":",":","U"," "," "," "," "," "," "," "," ","U",":",":",":",":",":","U","U"," "," "," "," "," ","S",":",":",":",":",":","S"," "," "," "," "," ","S","S","S","S","S","S","S"," "," "," "," "," ","E","E",":",":",":",":",":",":","E","E","E","E","E","E","E","E","E",":",":",":",":","E"},{" "," ","P",":",":",":",":","P"," "," "," "," "," ","P",":",":",":",":",":","P"," "," "," "," "," "," "," ","A",":",":",":",":",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," "," "," "," ","U",":",":",":",":",":","U"," "," "," "," "," "," "," "," ","U",":",":",":",":",":","U"," "," "," "," "," "," ","S",":",":",":",":",":","S"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","E",":",":",":",":",":","E"," "," "," "," "," "," "," ","E","E","E","E","E","E"},{" "," ","P",":",":",":",":","P"," "," "," "," "," ","P",":",":",":",":",":","P"," "," "," "," "," "," ","A",":",":",":",":",":","A",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," "," "," ","U",":",":",":",":",":","D"," "," "," "," "," "," "," "," ","D",":",":",":",":",":","U"," "," "," "," "," "," ","S",":",":",":",":",":","S"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","E",":",":",":",":",":","E"," "," "," "," "," "," "," "," "," "," "," "," "," "},{" "," ","P",":",":",":",":","P","P","P","P","P","P",":",":",":",":",":","P"," "," "," "," "," "," ","A",":",":",":",":",":","A"," ","A",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," "," ","U",":",":",":",":",":","D"," "," "," "," "," "," "," "," ","D",":",":",":",":",":","U"," "," "," "," "," "," "," ","S",":",":",":",":","S","S","S","S"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","E",":",":",":",":",":",":","E","E","E","E","E","E","E","E","E","E"," "," "," "},{" "," ","P",":",":",":",":",":",":",":",":",":",":",":",":",":","P","P"," "," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," ","U",":",":",":",":",":","D"," "," "," "," "," "," "," "," ","D",":",":",":",":",":","U"," "," "," "," "," "," "," "," ","S","S",":",":",":",":",":",":","S","S","S","S","S"," "," "," "," "," "," "," "," "," "," "," ","E",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","E"," "," "," "},{" "," ","P",":",":",":",":","P","P","P","P","P","P","P","P","P"," "," "," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," ","U",":",":",":",":",":","D"," "," "," "," "," "," "," "," ","D",":",":",":",":",":","U"," "," "," "," "," "," "," "," "," "," ","S","S","S",":",":",":",":",":",":",":",":","S","S"," "," "," "," "," "," "," "," "," ","E",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","E"," "," "," "},{" "," ","P",":",":",":",":","P"," "," "," "," "," "," "," "," "," "," "," "," "," "," ","A",":",":",":",":",":","A","A","A","A","A","A","A","A","A",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," ","U",":",":",":",":",":","D"," "," "," "," "," "," "," "," ","D",":",":",":",":",":","U"," "," "," "," "," "," "," "," "," "," "," "," "," ","S","S","S","S","S","S",":",":",":",":","S"," "," "," "," "," "," "," "," ","E",":",":",":",":",":",":","E","E","E","E","E","E","E","E","E","E"," "," "," "},{" "," ","P",":",":",":",":","P"," "," "," "," "," "," "," "," "," "," "," "," "," ","A",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","A"," "," "," "," "," "," "," "," ","U",":",":",":",":",":","D"," "," "," "," "," "," "," "," ","D",":",":",":",":",":","U"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","S",":",":",":",":",":","S"," "," "," "," "," "," "," ","E",":",":",":",":",":","E"," "," "," "," "," "," "," "," "," "," "," "," "," "},{" "," ","P",":",":",":",":","P"," "," "," "," "," "," "," "," "," "," "," "," ","A",":",":",":",":",":","A","A","A","A","A","A","A","A","A","A","A","A","A",":",":",":",":",":","A"," "," "," "," "," "," "," ","U",":",":",":",":",":",":","U"," "," "," "," "," "," ","U",":",":",":",":",":",":","U"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","S",":",":",":",":",":","S"," "," "," "," "," "," "," ","E",":",":",":",":",":","E"," "," "," "," "," "," "," ","E","E","E","E","E","E"},{"P","P",":",":",":",":",":",":","P","P"," "," "," "," "," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," "," ","U",":",":",":",":",":",":",":","U","U","U","U","U","U",":",":",":",":",":",":",":","U"," "," "," "," "," "," ","S","S","S","S","S","S","S"," "," "," "," "," ","S",":",":",":",":",":","S"," "," "," "," "," ","E","E",":",":",":",":",":",":","E","E","E","E","E","E","E","E",":",":",":",":",":","E"},{"P",":",":",":",":",":",":",":",":","P"," "," "," "," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," "," ","U","U",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","U","U"," "," "," "," "," "," "," ","S",":",":",":",":",":",":","S","S","S","S","S","S",":",":",":",":",":","S"," "," "," "," "," ","E",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","E"},{"P",":",":",":",":",":",":",":",":","P"," "," "," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","A",":",":",":",":",":","A"," "," "," "," "," "," "," ","U","U",":",":",":",":",":",":",":",":",":",":",":",":","U","U"," "," "," "," "," "," "," "," "," ","S",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","S","S"," "," "," "," "," "," ","E",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":",":","E"},{"P","P","P","P","P","P","P","P","P","P"," "," "," "," "," "," ","A","A","A","A","A","A","A"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","A","A","A","A","A","A","A"," "," "," "," "," "," "," "," ","U","U","U","U","U","U","U","U","U","U","U","U"," "," "," "," "," "," "," "," "," "," "," "," ","S","S","S","S","S","S","S","S","S","S","S","S","S","S","S"," "," "," "," "," "," "," "," ","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E","E"}};
        String stringHeures, stringMinutes, stringSecondes, stringTemps="";
        String[][] tableau = new String[27][156];
        int indiceChiffre=0;
        int[] xPosChiffre = {15,32,62,79,109,126};
        int[] xPosPoints = {51,99};
        int i;
        boolean isPause = false;

        HashMap<Character, String[][]> chiffres = new HashMap<>();
        chiffres.put('0', zero);
        chiffres.put('1', un);
        chiffres.put('2', deux);
        chiffres.put('3', trois);
        chiffres.put('4', quatre);
        chiffres.put('5', cinq);
        chiffres.put('6', six);
        chiffres.put('7', sept);
        chiffres.put('8', huit);
        chiffres.put('9', neuf);


        //quelles sont les pauses du jour
        jourr =jour.getDisplayName(TextStyle.FULL, Locale.forLanguageTag("fr-FR"));
        if (jourr.matches("lundi|mardi")) pauses[0] = "10:30:00";
        if (jourr.matches("lundi|mercredi")) pauses[3] = "16:00:00";
        if (jourr.equals("vendredi")) pauses[1] = "12:00:00";

        //custom
        //pauses[0] = "09:00:00";

        //quelle est la prochaine pause
        for (i=0; !mtn.isBefore(LocalTime.parse(pauses[i])); i++);
        pause = LocalTime.parse(pauses[i]);

  
        while (true){

            if (temps<=0 && !isPause) isPause = true;
            if (temps <= -900) {
                isPause = false;
                //quelle est la prochaine pause
                for (i=0; !mtn.isBefore(LocalTime.parse(pauses[i])); i++);
                pause = LocalTime.parse(pauses[i]);
            }

            //calcul de la durée
            mtn = LocalTime.now();
            duree = Duration.between(mtn, pause);
            temps = (int)duree.getSeconds();
            heures = temps/3600;
            minutes = (temps-heures*3600)/60;
            secondes = temps%60;
            //mise sous forme de string
            stringHeures = String.format("%02d",heures);
            stringMinutes = String.format("%02d",minutes);
            stringSecondes = String.format("%02d",secondes);
            stringTemps = stringHeures+stringMinutes+stringSecondes;

            //afficher si temps différent
            if (!stringTemps.equals(avant)){
                avant=stringTemps;

                for (int y=0; y<27;y++) {
                    for (int x=0; x<156; x++){
                        tableau[y][x]=" ";
                        if (x==0 || x==155 || y==0 || y==26) tableau[y][x] = "X";

                        if (!isPause) {
                            for (indiceChiffre=0; indiceChiffre<=5; indiceChiffre++) {
                                if (y>7 && y<19 && x>xPosChiffre[indiceChiffre] && x<xPosChiffre[indiceChiffre]+15)
                                    tableau[y][x] = chiffres.get(stringTemps.charAt(indiceChiffre))[y-8][x-xPosChiffre[indiceChiffre]];
                            }
                            for (int j=0; j<=1; j++) {
                                if (y>9 && y<19 && x>xPosPoints[j] && x<xPosPoints[j]+6)
                                    tableau[y][x] = points[y-10][x-xPosPoints[j]];
                            }
                        }
                        else if (y>5 && y<22 && x>15 && x<140) {
                            if (secondes%2==0) {
                                tableau[y][x] = " ";
                            }
                            else {
                                tableau[y][x] = textePause[y-6][x-16];
                            }
                        }
                    }
                    System.out.println();
                }

                //affichage
                System.out.println("\033\143");
                for (int y=0; y<27;y++) {
                    for (int x=0; x<156; x++){
                        System.out.print(tableau[y][x]);
                    }
                    System.out.println();
                }
            }
        }
    }
}
